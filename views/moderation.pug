extends moderation_layout

block content
    div(class="container forVue" style="margin:100px auto;")
        if user
            div(class="row")
                //- Если вошел в аккаунт то выводить вот это col-xs-6 col-md-3
                div(class="col-md-3")
                    div(class="card testimonial-card")
                            div(class="card-body")
                                h6(class="card-title") Система модерации и технической поддержки "ezResheine"
                                h6(class="card-title") Пользователь: #{user.nickname}
                    div(class="list-group")
                        a(class="list-group-item list-group-item-action active" href="#index" aria-controls="" role="tab" data-toggle="tab") Главная страница
                        a(class="list-group-item list-group-item-action" href="#moderation" aria-controls="" role="tab" data-toggle="tab") Модерация заказов
                        a(class="list-group-item list-group-item-action" href="#support" aria-controls="" role="tab" data-toggle="tab") Чат поддержки
                        a(class="list-group-item list-group-item-action" href="#users" aria-controls="" role="tab" data-toggle="tab") Пользователи
                        a(class="list-group-item list-group-item-action" href="#orderinfo" aria-controls="" role="tab" data-toggle="tab") Информация о заказе
                        a(class="list-group-item list-group-item-action" href="#bugreport" aria-controls="" role="tab" data-toggle="tab") Сообщение об ошибке
                div(class="col-md-9 card" style="padding:15px;")
                    div(class="tab-content verticale")
                        div(role="tabpanel" class="tab-pane active" id="index")
                            h3(style="text-align:center") Система модерации - главная страница
                            hr(class="half-rule")
                            p Добро пожаловать в систему модерации Web-ресурса "ezReshenie", #{user.username}!
                            hr(class="half-rule")
                            p Ссылки:
                            a(href="/") Главная страница сайта
                            br
                            a(href="/users/user_info") Переход в личный кабинет пользователя
                        div(role="tabpanel" class="tab-pane" id="bugreport") 
                                form(method="POST" action="/minsertbugs") 
                                    h3(style="text-align:center") Отправка отчета об ошибках
                                    hr(class="half-rule")
                                    div(class="container post-create-form")
                                        input(type="text" class="form-control username_h" id="inputPrefilledEx" name="user" value="Система модерации" style="display: none;")
                                        input(value="" type="text" required name="postTitle" id="inputPrefilledEx" class="form-control" placeholder="Тема" style="margin-bottom: 10px;")
                                        textarea(style="padding:5px;" required name="postText" class="form-control z-depth-1" id="exampleFormControlTextarea6" rows="3" placeholder="Пожалуйста опишите найденную ошибку...")
                                        div(style="display: flex; justify-content: center;")
                                            button(type="submit" class="btn btn-default add-comment pull-right")
                                                 p(style="display: inline;") Отправить
                        div(role="tabpanel" class="tab-pane" id="moderation")
                                h3(style="text-align:center") Модерация заказов
                                hr(class="half-rule")
                                div(class="select-buttons")
                                    ul(class="nav nav-tabs")
                                        li(role="presentation" class="nav-item active")
                                             a(class="nav-link active" href="#pending" aria-controls="pending" role="tab" data-toggle="tab") Ожидают модерации
                                        li(role="presentation")
                                            a(class="nav-link" href="#denied" aria-controls="denied" role="tab" data-toggle="tab") Отклонены
                                div(class="tab-content" class="nav-item")
                                    div(role="tabpanel" class="tab-pane active pending" id="pending")
                                    div(role="tabpanel" class="tab-pane denied" id="denied")
                                div(class="media posts")             
                                    script(type='text/javascript'). 
                                        $('#myTabs a').click(function (e) {
                                            e.preventDefault()
                                            $(this).tab('show')
                                        })
                                        var pending = [!{reviews}];
                                        var denied = [!{rdenied}];
                                        for(var i=0;i<pending.length;i++){
                                            $(".pending").append('<div class="bs-callout bs-callout-danger" id="callout-progress-animation-css3"><h4 style="margin-top: 15px;">Заказ ID '+pending[i].id+'</h3><p>Предмет: '+pending[i].topic+'</p><p>Тип: '+pending[i].type+'</p><p>Описание:'+pending[i].subject+'</p><p>Заказчик: '+pending[i].autor_order+'</p><p>Прикрепленный файл: '+pending[i].file+'</p><p>Цена: '+pending[i].price+' руб.</p><br><form method="POST" action="/ordmod"><input type="text" name="id" style="display: none;"><button type="st_fixed" class="btn btn-success btn-sm">Одобрить</button><button formaction="/moderation/ordedit" type="st_fixed" class="btn btn-warning btn-sm">Редактировать и одобрить</button><button formaction="/orddeny" type="st_fixed" class="btn btn-danger btn-sm">Отклонить</button></form><hr class="half-rule"></div>');
                                            document.getElementsByName("id")[i].value=pending[i].id;
                                        }
                                        for(var a=0;a<denied.length;a++){
                                            $(".denied").append('<div class="bs-callout bs-callout-success" id="callout-progress-animation-css3"><h4 style="margin-top: 15px;">Отзыв ID '+denied[a].id+' к заказу ID '+denied[a].order_id+'</h3><p>'+denied[a].text+'</p><small>Отправитель '+denied[a].sender+', ID: '+denied[a].sender_id+'</small><br><form method="POST" action="/revmod"><input type="text" name="id" style="display: none;"><button type="st_fixed" class="btn btn-success btn-sm">Опубликовать</button><button formaction="/moderation/revedit" type="st_fixed" class="btn btn-warning btn-sm">Редактировать и опубликовать</button></form><hr class="half-rule"></div>');
                                            document.getElementsByName("id")[a].value=denied[a].id;
                                        }
                        div(role="tabpanel" class="tab-pane" id="orderinfo")
                                h3(style="text-align:center") Запрос информации о заказе
                                hr(class="half-rule") 
                                p Запрос информации о заказе производится по его номеру (ID). Для получения информации о заказе введите его номер в форму ниже.
                                p Информация будет выведена на отдельной странице в виде таблицы.
                                hr(class="half-rule") 
                                form(method="POST" action="/moderation/orderinfo")
                                    div(class="form-group col-mb-6")
                                        label(for="id") Введите номер заказа: 
                                        input(class="form-control" name="id" placeholder="Номер заказа" required)
                                        button(class="btn btn-success btn-sm") Получить информацию
                        div(role="tabpanel" class="tab-pane" id="users")
                                h3(style="text-align:center") Список пользователей
                                hr(class="half-rule")
                                div(class="select-buttons")
                                    ul(class="nav nav-tabs")
                                        li(role="presentation" class="nav-item active")
                                             a(class="nav-link active" href="#users" aria-controls="pending" role="tab" data-toggle="tab") Пользователи
                                        li(role="presentation")
                                            a(class="nav-link" href="#banned" aria-controls="banned" role="tab" data-toggle="tab") Заблокированные пользователи
                                div(class="tab-content" class="nav-item")
                                    div(role="tabpanel" class="tab-pane active users" id="users")
                                    div(role="tabpanel" class="tab-pane banned" id="banned")
                                div(class="media posts")             
                                    script(type='text/javascript'). 
                                        $('#myTabs a').click(function (e) {
                                            e.preventDefault()
                                            $(this).tab('show')
                                        })
                                    table(class="table-striped table-responsive" style="display: table !important;")
                                        thead
                                            tr
                                                th(scope="col") ID
                                                th(scope="col") Имя
                                                th(scope="col") E-Mail
                                                th(scope="col") Телефон
                                                th(scope="col") Действия
                                        tbody
                                            tr
                                                td(scope="row") 1
                                                td(scope="row") admin
                                                td(scope="row") admin@localhost
                                                td(scope="row") +71112223344
                                                td(scope="row")
                                                    div(style="display: flex; justify-content: space-around;")
                                                        button(class="btn btn-default btn-sm") Чат
                                                        button(class="btn btn-warning btn-sm") Предупреждение
                                                        button(class="btn btn-danger btn-sm") Блокировка
                                            tr
                                                td 2
                                                td moderator
                                                td moder@localhost
                                                td 
                                                td
                                                    div(style="display: flex; justify-content: space-around;")
                                                        button(class="btn btn-default btn-sm") Чат
                                                        button(class="btn btn-warning btn-sm") Предупреждение
                                                        button(class="btn btn-danger btn-sm") Блокировка
                                            tr
                                                td 3
                                                td test12
                                                td 
                                                td 
                                                td
                                                    div(style="display: flex; justify-content: space-around;")
                                                        button(class="btn btn-default btn-sm") Чат
                                                        button(class="btn btn-warning btn-sm") Предупреждение
                                                        button(class="btn btn-danger btn-sm") Блокировка
                                            tr
                                                td 4
                                                td Jane
                                                td test34@gmail.com
                                                td +73335156709
                                                td
                                                    div(style="display: flex; justify-content: space-around;")
                                                        button(class="btn btn-default btn-sm") Чат
                                                        button(class="btn btn-warning btn-sm") Предупреждение
                                                        button(class="btn btn-danger btn-sm") Блокировка
                    script.
                        $('#myTabs a').click(function (e) {
                            e.preventDefault()
                            $(this).tab('show')
                        })

        else
            //- Если человек не вошел в аккаунт то ему выводить это
            p Пожалуйста войдите в аккаунт
            a(href="/users/login") Вход