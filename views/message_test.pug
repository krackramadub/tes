extend layout

block content
    div(class="container" id="room")
        ul(style="margin-bottom:10px;list-style-type:none;")
            form
                input(class="form-control" autocomplete="off" autofocus placeholder="Message...")
    script(src="/socket.io/socket.io.js")
    script.
        var socket = io.connect('',{
            reconect: false
        });

        var form = $('#room form');
        var ul = $('#room ul')[0];
        
        form.submit(function(){
            var input = $(this).find('input');
            var text = input.val();
            input.val('');

            socket.emit('message',text,function(data){
                console.log(data);
                $('<li>',{text:text}).appendTo(ul);
            });
            return false;
        })
        function printStatus(status,color){
            $('<li>').append($('<i>').text(status).css('color',color)).appendTo(ul);
        }
        socket.on('message',function(text){
            $('<li>',{text:text}).appendTo(ul);
        });
        socket.on('connect',function(){
            printStatus('*** [OK] Соединение установлено ***','green');
        })
        socket.on('disconnect',function(){
             printStatus('*** [ERR] Соединеник потеряно ***','red')
        })
        socket.on('reconnect_failed',function(){
            alert("Соединение не удалось восстановить. Пожалуйста, обновите страницу.")
        })